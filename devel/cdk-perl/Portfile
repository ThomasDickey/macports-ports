# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem      1.0

name            cdk-perl
version         20240606

categories      devel
license         X11

maintainers     {@ThomasDickey invisible-island.net:dickey} openmaintainer

description     Curses Development Kit -- Perl extension
long_description  \
    Cdk stands for \"Curses Development Kit\".  It contains a large number of \
    ready to use widgets which facilitate the speedy development of \
    full-screen curses programs.

homepage        https://invisible-island.net/cdk/
master_sites    https://invisible-island.net/archives/cdk/ \
                https://invisible-mirror.net/archives/cdk/
extract.suffix  .tgz

checksums       rmd160  e05d7295a93e21e3900e6e7d2c01a1f71724569a \
                sha256  910bc290441f6c73ca4f8c67748cc09633f7aebbc669cca7b95bc50bf4f1f21c \
                size    227322

depends_lib     port:cdk \
                port:ncurses \
                port:perl5

configure.args  --with-screen=ncursesw

post-destroot {
    foreach badfile [exec find ${destroot} -name perllocal.pod] {
        file delete ${badfile}
    }

    xinstall -m 755 -d ${destroot}${prefix}/share/doc/${name}
    xinstall -m 644 -W ${worksrcpath} CHANGES COPYING README VERSION \
        ${destroot}${prefix}/share/doc/${name}
    file copy ${worksrcpath}/demos \
            ${destroot}${prefix}/share/doc/${name}/demos
    file copy ${worksrcpath}/examples \
            ${destroot}${prefix}/share/doc/${name}/examples
    file copy ${worksrcpath}/fulldemo \
            ${destroot}${prefix}/share/doc/${name}/fulldemo

    foreach demofile [exec find ${destroot}${prefix}/share/doc -type f] {
        file attributes ${demofile} -permissions -x
        reinplace -q "s|#!/usr/bin/perl|#!${prefix}/bin/perl|" ${demofile}
    }
}

livecheck.regex ${name}-(\[0-9\]+)
